{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\froman\fcharset0 Times-Roman;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0;}
\margl1440\margr1440\vieww37900\viewh18480\viewkind0
\deftab720
\pard\pardeftab720\sa240\partightenfactor0

\f0\fs24 \cf0 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 import\'a0csv\
import\'a0openai\
\
#\'a0Set\'a0your\'a0OpenAI\'a0API\'a0key\'a0here\
openai.api_key\'a0=\'a0'your-api-key-here'\'a0\'a0#\'a0Replace\'a0with\'a0your\'a0actual\'a0OpenAI\'a0API\'a0key\
\
#\'a0Function\'a0to\'a0generate\'a0a\'a0prompt\'a0for\'a0ChatGPT\'a0based\'a0on\'a0the\'a0comment\'a0and\'a0industry\
def\'a0generate_prompt(comment,\'a0industry):\
\'a0\'a0\'a0\'a0return\'a0f"""\
You\'a0are\'a0an\'a0expert\'a0in\'a0customer\'a0experience\'a0for\'a0the\'a0\{industry\}\'a0industry.\
Analyze\'a0the\'a0following\'a0survey\'a0comment\'a0and\'a0tag\'a0it\'a0with\'a0the\'a0appropriate\'a0customer\'a0journey\'a0stage:\
(Awareness,\'a0Consideration,\'a0Purchase,\'a0Retention,\'a0Advocacy)\
\
Comment:\'a0"\{comment\}"\
\
Respond\'a0with\'a0only\'a0the\'a0customer\'a0journey\'a0stage.\
"""\
\
#\'a0Define\'a0input\'a0and\'a0output\'a0file\'a0paths\
input_file\'a0=\'a0'survey_comments.csv'\'a0\'a0\'a0\'a0\'a0\'a0\'a0#\'a0Input\'a0CSV\'a0file\'a0containing\'a0survey\'a0comments\
output_file\'a0=\'a0'tagged_comments.csv'\'a0\'a0\'a0\'a0\'a0\'a0#\'a0Output\'a0CSV\'a0file\'a0to\'a0store\'a0tagged\'a0results\
\
#\'a0Open\'a0the\'a0input\'a0file\'a0for\'a0reading\'a0and\'a0output\'a0file\'a0for\'a0writing\
with\'a0open(input_file,\'a0mode='r',\'a0encoding='utf-8')\'a0as\'a0infile,\'a0\\\
\'a0\'a0\'a0\'a0\'a0open(output_file,\'a0mode='w',\'a0newline='',\'a0encoding='utf-8')\'a0as\'a0outfile:\
\
\'a0\'a0\'a0\'a0#\'a0Create\'a0a\'a0CSV\'a0reader\'a0to\'a0parse\'a0the\'a0input\'a0file\
\'a0\'a0\'a0\'a0reader\'a0=\'a0csv.DictReader(infile)\
\
\'a0\'a0\'a0\'a0#\'a0Add\'a0a\'a0new\'a0column\'a0for\'a0the\'a0customer\'a0journey\'a0tag\
\'a0\'a0\'a0\'a0fieldnames\'a0=\'a0reader.fieldnames\'a0+\'a0['CustomerJourneyTag']\
\
\'a0\'a0\'a0\'a0#\'a0Create\'a0a\'a0CSV\'a0writer\'a0to\'a0write\'a0to\'a0the\'a0output\'a0file\
\'a0\'a0\'a0\'a0writer\'a0=\'a0csv.DictWriter(outfile,\'a0fieldnames=fieldnames)\
\'a0\'a0\'a0\'a0writer.writeheader()\'a0\'a0#\'a0Write\'a0the\'a0header\'a0row\'a0to\'a0the\'a0output\'a0file\
\
\'a0\'a0\'a0\'a0#\'a0Process\'a0each\'a0row\'a0in\'a0the\'a0input\'a0file\
\'a0\'a0\'a0\'a0for\'a0row\'a0in\'a0reader:\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0comment\'a0=\'a0row['Comment']\'a0\'a0#\'a0Extract\'a0the\'a0survey\'a0comment\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0industry\'a0=\'a0row.get('Industry',\'a0'general')\'a0\'a0#\'a0Extract\'a0industry\'a0or\'a0default\'a0to\'a0'general'\
\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0#\'a0Generate\'a0a\'a0prompt\'a0for\'a0ChatGPT\'a0using\'a0the\'a0comment\'a0and\'a0industry\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0prompt\'a0=\'a0generate_prompt(comment,\'a0industry)\
\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0#\'a0Send\'a0the\'a0prompt\'a0to\'a0ChatGPT\'a0using\'a0the\'a0ChatCompletion\'a0API\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0response\'a0=\'a0openai.ChatCompletion.create(\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0model='gpt-3.5-turbo',\'a0\'a0#\'a0Specify\'a0the\'a0model\'a0to\'a0use\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0messages=[\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{"role":\'a0"system",\'a0"content":\'a0"You\'a0are\'a0a\'a0helpful\'a0assistant."\},\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\{"role":\'a0"user",\'a0"content":\'a0prompt\}\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0]\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0)\
\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0#\'a0Extract\'a0the\'a0customer\'a0journey\'a0tag\'a0from\'a0the\'a0response\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0tag\'a0=\'a0response['choices'][0]['message']['content'].strip()\
\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0#\'a0Add\'a0the\'a0tag\'a0to\'a0the\'a0current\'a0row\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0row['CustomerJourneyTag']\'a0=\'a0tag\
\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0#\'a0Write\'a0the\'a0updated\'a0row\'a0to\'a0the\'a0output\'a0file\
\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0writer.writerow(row)\
\
#\'a0Print\'a0a\'a0message\'a0when\'a0processing\'a0is\'a0complete\
print(f"Tagged\'a0survey\'a0comments\'a0have\'a0been\'a0saved\'a0to\'a0'\{output_file\}'.")\
\
}